# devops-netology
devops-10 student

HW-3.7. Компьютерные сети, лекция 2

**************
Использовал виртуализацию parallels c ВМ ubuntu 20.04 для arm64
**************

п.1
parallels@ubuntu-linux-20-04-desktop:~$ ip link show

1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue state UNKNOWN mode DEFAULT group default qlen 1000
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
2: eth0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc fq_codel state UP mode DEFAULT group default qlen 1000
    link/ether 00:1c:42:bb:c7:a6 brd ff:ff:ff:ff:ff:ff
    
parallels@ubuntu-linux-20-04-desktop:~$ nmcli device status

DEVICE  TYPE      STATE      CONNECTION 
eth0    ethernet  unmanaged  --         
lo      loopback  unmanaged  -- 

parallels@ubuntu-linux-20-04-desktop:~$ netstat -i

Kernel Interface table
Iface      MTU    RX-OK RX-ERR RX-DRP RX-OVR    TX-OK TX-ERR TX-DRP TX-OVR Flg
eth0      1500     1479      0      0 0          1456      0      0      0 BMRU
lo       65536      437      0      0 0           437      0      0      0 LRU

п.2
Neighbor Discovery Protocol (NDP) — протокол из набора протоколов TCP/IP, используемый совместно с IPv6. Заменяет применяемые в IPv4 протоколы ARP, ICMP. Вместо использующихся в протоколе ARP широковещательных пакетов канального уровня используются групповые сообщения (multicast) не на канальном, а на сетевом уровне, что должно значительно снизить широковещательный трафик. Усовершенствованы функции протокола ICMP, облегчая работу разных подсетей в одном физическом сегменте. Включен механизм распознавания неисправных маршрутизаторов, что позволяет повысить устойчивость к сбоям оборудования. В дополнение к имевшимся ранее двум типам адресации — Unicast и Multicast (доставке уникальному получателю или группе получателей) — добавлен третий — Anycast, при котором осуществляется доставка любому получателю из группы.

Пакет называется libndp-tools
Команды npdtool, ndpmon

п.3
Для разделения L2 коммутатора на несколько виртуальных сетей используется технология VLAN.
Данная технология описана стандартом 802.1Q и предусматривает добавление к заголовкам ethernet-кадра дополнительного поля, которое содержит в том числе определенную метку (тег) с номером виртуальной сети - VLAN ID, всего можно создать 4094 сети.

Используется пакет iproute2
Используются команды vconfig, ip

Пример конфига:
$ sudo vim /etc/network/interfaces

##vlan с ID-100 для интерфейса eth0 with ID - 100 в Debian/Ubuntu Linux##
##«поднимать» интерфейс при запуске сетевой службы
auto eth0.100
##название интерфейса
iface eth0.100 inet static
address 192.168.1.200
netmask 255.255.255.0
##указывает на каком физическом интерфейсе создавать VLAN
vlan-raw-device eth0

Для того, чтобы применить изменения, необходимо перезапустить сетевую службу
$ sudo systemctl restart networking.service

п.4
Объединение сетевых интерфейсов(Bonding) – это механизм, используемый Linux-серверами и предполагающий связь нескольких физических интерфейсов в один виртуальный, что позволяет обеспечить большую пропускную способность или отказоустойчивость в случае повреждения кабеля. 
Доступные режимы работы:
mode=0 (balance-rr)
При этом методе объединения трафик распределяется по принципу «карусели»: пакеты по очереди направляются на сетевые карты объединённого интерфейса. Например, если у нас есть физические интерфейсы eth0, eth1, eth2, объединенные в bond0, первый пакет будет отправляться через eth0, второй — через eth1, третий — через eth2, а четвертый снова через eth0 и т.д.

mode=1 (active-backup)
Когда используется этот метод, активен только один физический интерфейс, а остальные работают как резервные на случай отказа основного.

mode=2 (balance-xor)
В данном случае объединенный интерфейс определяет, через какую физическую сетевую карту отправить пакеты, в зависимости от MAC-адресов источника и получателя.

mode=3 (broadcast) Широковещательный режим, все пакеты отправляются через каждый интерфейс. Имеет ограниченное применение, но обеспечивает значительную отказоустойчивость.

mode=4 (802.3ad)
Особый режим объединения. Для него требуется специально настраивать коммутатор, к которому подключен объединенный интерфейс. Реализует стандарты объединения каналов IEEE и обеспечивает как увеличение пропускной способности, так и отказоустойчивость.

mode=5 (balance-tlb)
Распределение нагрузки при передаче. Входящий трафик обрабатывается в обычном режиме, а при передаче интерфейс определяется на основе данных о загруженности.

mode=6 (balance-alb)
Адаптивное распределение нагрузки. Аналогично предыдущему режиму, но с возможностью балансировать также входящую нагрузку.

Пример конфига:
$ sudo vim /etc/network/interfaces

# The primary network interface
auto bond0
iface bond0 inet static
    address 192.168.1.150
    netmask 255.255.255.0    
    gateway 192.168.1.1
    dns-nameservers 192.168.1.1 8.8.8.8
    dns-search domain.local
        slaves eth0 eth1
        bond_mode 0
        bond-miimon 100
        bond_downdelay 200
        bound_updelay 200
        
Для того, чтобы применить изменения, необходимо перезапустить сетевую службу
$ sudo systemctl restart networking.service

п.5
маска /29 может содержать до 8 Ip-адресов
